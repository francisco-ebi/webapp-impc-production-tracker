<mat-card appearance="outlined">
  <mat-card-content>
    <a [routerLink]="['history']">History</a>
    <div>
      <app-go-back></app-go-back>
    </div>
  </mat-card-content>
</mat-card>

@if (plan.pin) {
  <app-plan-details [canUpdatePlan]="canUpdatePlan" [plan]="plan">
  </app-plan-details>
}

<div class="section">
  @if (plan.statusTransition) {
    <app-status-transition [statusTransition]="plan.statusTransition"
      [canUpdate]="canUpdatePlan">
    </app-status-transition>
  }
  <app-status-date [statusDates]="plan.statusDates" [title]='"Plan Status History"'></app-status-date>
</div>

@if (plan.phenotypingAttemptResponse) {
  <app-phenotyping-attempt [plan]=plan [phenotypingAttempt]="plan.phenotypingAttemptResponse"
    [canUpdatePlan]="canUpdatePlan">
  </app-phenotyping-attempt>
}

<mat-card appearance="outlined">
  <mat-card-content>
    @if (canUpdatePlan) {
      <button mat-raised-button color="primary" [disabled]="!shouldShowUpdateButton()"
      (click)="updatePlan()">Update</button>
    }
    <br>
    <span style="font-size: 12px; ">* required fields</span>
    <div class="separation"></div>
    @if (error) {
      <div class="alert alert-danger">{{ error }}</div>
    }
  </mat-card-content>
</mat-card>

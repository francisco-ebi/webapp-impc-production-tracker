
<div class="main-container">
  <h1>Reports</h1>
  <h3>IMPC Production Numbers</h3>
  <div class="container">
    <div>
      <div class="total-genes-wrapper">
        Number of genes with genotype confirmed lines:
        <ng-container *ngIf="totalNumOfGenes$ | async as totalNumOfGenes; else loading">
          {{ totalNumOfGenes | number }}
        </ng-container>
        <ng-template #loading>
          <ngx-skeleton-loader count="1" [theme]="{'margin-bottom': 0}"></ngx-skeleton-loader>
        </ng-template>
      </div>
      <p>
        <a href="https://www.gentar.org/tracker-api/api/reports/glt_production_numbers/overlap/intersection" download>
          Genes studied by both ES Cell and CRISPR based techniques
        </a>
      </p>
    </div>
  </div>
  <div class="chart-container">
    <div class="loading-overlay" *ngIf="isLoading || !charDataIsAvailable ">
      <mat-spinner *ngIf="isLoading"></mat-spinner>
      <h2 *ngIf="!charDataIsAvailable">There is no data available for the filters selected</h2>
    </div>
    <canvas
      baseChart
      class="chart"
      [type]="'line'"
      [data]="chartData"
      [options]="lineChartOptions"
    >
    </canvas>
    <div>
      <p *ngIf="selectedWorkUnit">Filtering by {{selectedWorkUnit}} work unit</p>
    </div>
  </div>
  <div class="controls">
    <mat-form-field>
      <mat-label>Work unit</mat-label>
      <input
        type="text"
        placeholder="Pick one"
        aria-label="Work unit"
        matInput
        #workUnitInput
        [matAutocomplete]="workUnitAutocomplete"
      >
      <mat-autocomplete #workUnitAutocomplete="matAutocomplete">
        <mat-option *ngFor="let unit of workUnits$ | async" [value]="unit">
          {{ unit }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Work group</mat-label>
      <input
        type="text"
        placeholder="Pick one"
        aria-label="Work group"
        matInput
        #workGroupInput
        [matAutocomplete]="workGroupAutocomplete"
      >
      <mat-autocomplete #workGroupAutocomplete="matAutocomplete">
        <mat-option *ngFor="let group of workGroups$ | async" [value]="group">
          {{ group }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>
    <mat-form-field>
      <mat-label>Start date</mat-label>
      <input
        matInput
        [matDatepicker]="startDateDP"
        [value]="selectedStartDate"
        (dateChange)="onChangedDate('selectedStartDate', $event)"
      >
      <mat-hint>MM/YYYY</mat-hint>
      <mat-datepicker-toggle matIconSuffix [for]="startDateDP"></mat-datepicker-toggle>
      <mat-datepicker
        #startDateDP
        startView="multi-year"
        (monthSelected)="onSelectedMonth('selectedStartDate', $event, startDateDP)"
      >
      </mat-datepicker>
    </mat-form-field>
    <mat-form-field>
      <mat-label>End date</mat-label>
      <input
        matInput
        [matDatepicker]="endDateDP"
        [value]="selectedEndDate"
        (dateChange)="onChangedDate('selectedEndDate', $event)"
      >
      <mat-hint>MM/YYYY</mat-hint>
      <mat-datepicker-toggle matIconSuffix [for]="endDateDP"></mat-datepicker-toggle>
      <mat-datepicker
        #endDateDP
        startView="multi-year"
        (monthSelected)="onSelectedMonth('selectedEndDate', $event, endDateDP)"
      >
      </mat-datepicker>
    </mat-form-field>
  </div>
</div>
